<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>채용공고 상세정보</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            color: #333;
        }
        .header-section, .content-section {
            margin-bottom: 20px;
        }
        .header-section table {
            width: 100%;
            border-collapse: collapse;
        }
        .header-section th, .header-section td {
            padding: 10px;
            text-align: left;
        }
        .header-section th {
            font-weight: bold;
            color: #0056b3;
        }
        .content-section h2 {
            font-size: 1.5rem;
            color: #0056b3;
            margin-bottom: 10px;
        }
        .content-section table {
            width: 100%;
            border-collapse: collapse;
        }
        .content-section th, .content-section td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        .content-section th {
            background-color: #f4f4f4;
            font-weight: bold;
        }
        a {
            color: #0056b3;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <header>
        <a href="javascript:history.back()">뒤로가기</a>
    </header>
    <h1>채용공고 상세정보</h1>
    <div id="detailContainer">
        <p>데이터를 불러오는 중입니다...</p>
    </div>

    <script>
        const apiUrl = "https://apis.data.go.kr/1051000/recruitment/detail";
        const serviceKey = "pKNkTBCcfio%2B4XDb3xpeAScbhWpzcdlcXlYBMywYpX%2Bu0h9nUw1m3WekTcTneCAnG4KgnpW14Z7dXAjbT6tRmw%3D%3D";

        const urlParams = new URLSearchParams(window.location.search);
        const sn = urlParams.get("sn");

        if (sn) {
            const fullUrl = `${apiUrl}?serviceKey=${serviceKey}&resultType=json&sn=${sn}`;
            fetch(fullUrl)
                .then(response => response.json())
                .then(data => {
                    const result = data.result;
                    const container = document.getElementById("detailContainer");

                    if (result) {
                        container.innerHTML = `
                            <div class="header-section">
                                <table>
                                    <tr>
                                        <th>공고명</th>
                                        <td>${result.recrutPbancTtl || "정보 없음"}</td>
                                        <th>공고기관</th>
                                        <td>${result.instNm || "정보 없음"}</td>
                                    </tr>
                                    <tr>
                                        <th>공고기간</th>
                                        <td>${result.pbancBgngYmd || "정보 없음"} ~ ${result.pbancEndYmd || "정보 없음"}</td>
                                        <th>고용형태</th>
                                        <td>${result.hireTypeNmLst || "정보 없음"}</td>
                                    </tr>
                                    <tr>
                                        <th>채용분야</th>
                                        <td>${result.ncsCdNmLst || "정보 없음"}</td>
                                        <th>근무지</th>
                                        <td>${result.workRgnNmLst || "정보 없음"}</td>
                                    </tr>
                                    <tr>
                                        <th>채용구분</th>
                                        <td>${result.recrutSeNm || "정보 없음"}</td>
                                        <th>채용인원</th>
                                        <td>${result.recrutNope || "정보 없음"}</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="content-section">
                                <h2>응시자격</h2>
                                <p>${result.aplyQlfcCn.replace(/\r\n/g, "<br>") || "정보 없음"}</p>
                            </div>
                            <div class="content-section">
                                <h2>결격사유</h2>
                                <p>${result.disqlfcRsn.replace(/\r\n/g, "<br>") || "정보 없음"}</p>
                            </div>
                            <div class="content-section">
                                <h2>우대조건</h2>
                                <p>${result.prefCn.replace(/\r\n/g, "<br>") || "정보 없음"}</p>
                            </div>
                            <div class="content-section">
                                <h2>전형절차</h2>
                                <p>${result.scrnprcdrMthdExpln.replace(/\r\n/g, "<br>") || "정보 없음"}</p>
                            </div>
                            <div class="content-section">
                                <h2>첨부파일</h2>
                                <table>
                                    <thead>
                                        <tr>
                                            <th>파일명</th>
                                            <th>파일유형</th>
                                            <th>다운로드</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${result.files && result.files.length > 0 ? result.files.map(file => `
                                            <tr>
                                                <td>${file.atchFileNm || "정보 없음"}</td>
                                                <td>${file.atchFileType || "정보 없음"}</td>
                                                <td><a href="${file.url}" target="_blank">다운로드</a></td>
                                            </tr>
                                        `).join("") : `<tr><td colspan="3">첨부파일 없음</td></tr>`}
                                    </tbody>
                                </table>
                            </div>
                        `;
                    } else {
                        container.innerHTML = "<p>상세정보를 찾을 수 없습니다.</p>";
                    }
                })
                .catch(error => {
                    document.getElementById("detailContainer").innerHTML = `<p>API 요청 실패: ${error.message}</p>`;
                });
        } else {
            document.getElementById("detailContainer").innerHTML = "<p>유효하지 않은 요청입니다.</p>";
        }
    </script>
</body>
</html>
